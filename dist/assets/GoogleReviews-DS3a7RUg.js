import{j as e}from"./index-LaZJjqnh.js";import{r as t}from"./react-vendor-DUMDxmrn.js";import{S as i}from"./icons-GV0ki0f9.js";const s="google-maps-script",a="ChIJUQehZpUZ50YRMFClZ11adkM",r=()=>{const[r,o]=t.useState([]),[n,l]=t.useState(!0),[,c]=t.useState(null),[d,m]=t.useState(0),[g,p]=t.useState(0),[h,u]=t.useState(0),[x,w]=t.useState(!0);t.useEffect((()=>{const e=new IntersectionObserver((t=>{t[0].isIntersecting&&(v(),e.disconnect())}));return e.observe(document.getElementById("reviews-section")||document.body),()=>e.disconnect()}),[]),t.useEffect((()=>{let e;return x&&r.length>3&&(e=setInterval((()=>{p((e=>(e+1)%r.length))}),5e3)),()=>clearInterval(e)}),[x,r.length]);const v=async()=>{try{const e=await fetch("/.netlify/functions/google-reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({placeId:a})});if(e.ok){const t=await e.json();if(Array.isArray(t.reviews)&&t.reviews.length>0){const e=[...t.reviews].sort(((e,t)=>t.time-e.time));return o(e),m(t.rating||0),u(t.user_ratings_total||e.length),void l(!1)}}}catch(e){}if(document.getElementById(s))window.google&&window.google.maps?f():b();else try{const e=document.createElement("script");e.id=s,e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyANfuPj8nnzPV9Lf_2gLUFSVXKEFu_bybw&v=weekly&loading=async&libraries=places&language=lt&region=LT",e.async=!0,e.defer=!0,e.onload=f,e.onerror=e=>{c("Nepavyko įkelti Google Maps API"),b()},document.head.appendChild(e)}catch(t){b()}};async function f(){var e,t;try{if(!window.google||!window.google.maps)return c("Google Maps API neprieinama"),void b();let i,s;if("function"==typeof window.google.maps.importLibrary)await window.google.maps.importLibrary("places"),i=null==(e=window.google.maps.places)?void 0:e.PlacesService,s=null==(t=window.google.maps.places)?void 0:t.PlacesServiceStatus;else{if(!window.google.maps.places)return c("Google Maps API neprieinama"),void b();i=window.google.maps.places.PlacesService,s=window.google.maps.places.PlacesServiceStatus}const r=new i(document.createElement("div")),n=(e=1)=>{r.getDetails({placeId:a,fields:["reviews","rating","user_ratings_total"]},((t,i)=>{if(i===s.OK&&(null==t?void 0:t.reviews)&&Array.isArray(t.reviews)&&t.reviews.length>0){const e=[...t.reviews].sort(((e,t)=>t.time-e.time));o(e),t.rating&&m(t.rating),u(t.user_ratings_total||e.length),l(!1)}else e<2?setTimeout((()=>n(e+1)),800):(c("Nepavyko gauti atsiliepimų"),b(),l(!1))}))};n()}catch(i){c("Įvyko klaida inicijuojant Google Maps"),b()}}const b=()=>{const e=[{author_name:"Tomas Petrauskas",profile_photo_url:"",rating:5,relative_time_description:"prieš mėnesį",text:"Labai operatyvus ir profesionalus aptarnavimas. Atvyko laiku ir greitai išnešė seną šaldytuvą.",time:Date.now()/1e3-2592e3},{author_name:"Laura Kazlauskienė",profile_photo_url:"",rating:5,relative_time_description:"prieš 2 mėnesius",text:"Puiki paslauga! Išvežė seną skalbimo mašiną ir indaplovę. Rekomenduoju visiems.",time:Date.now()/1e3-5184e3},{author_name:"Marius Jonaitis",profile_photo_url:"",rating:4,relative_time_description:"prieš 3 mėnesius",text:"Greitai ir kokybiškai išvežė senus baldus. Labai patenkinti paslaugomis.",time:Date.now()/1e3-7776e3}];o(e),m(4.7),u(e.length),l(!1),c(null)},y=t=>{const s=[];for(let a=1;a<=5;a++)s.push(e.jsx(i,{className:"w-5 h-5 "+(a<=t?"text-yellow-400 fill-yellow-400":"text-gray-300")},a));return s},j=()=>{w(!1),p((e=>(e-1+r.length)%r.length)),setTimeout((()=>w(!0)),1e4)},k=()=>{w(!1),p((e=>(e+1)%r.length)),setTimeout((()=>w(!0)),1e4)};return n?e.jsx("div",{id:"reviews-section",className:"flex justify-center items-center py-16 bg-gray-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#167d36]"})}):e.jsx("section",{id:"reviews-section",className:"py-16 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Klientų atsiliepimai"}),e.jsx("div",{className:"flex justify-center items-center space-x-1 mb-2",children:y(d)}),e.jsxs("p",{className:"text-lg text-gray-600",children:[d.toFixed(1)," iš 5 (",h," atsiliepimai)"]})]}),e.jsxs("div",{className:"relative",onMouseEnter:()=>w(!1),onMouseLeave:()=>w(!0),children:[r.length>3&&e.jsx("button",{onClick:j,className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-white rounded-full p-2 shadow-md text-[#167d36] hover:text-white hover:bg-[#167d36] transition-colors hidden md:block","aria-label":"Ankstesnis atsiliepimas",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",role:"region","aria-label":"Google atsiliepimai",tabIndex:0,onKeyDown:e=>{"ArrowLeft"===e.key?j():"ArrowRight"===e.key&&k()},children:(()=>{if(0===r.length)return[];const e=[],t=Math.min(3,r.length);for(let i=0;i<t;i++){const t=(g+i)%r.length;e.push(r[t])}return e})().map(((t,i)=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow",itemScope:!0,itemType:"http://schema.org/Review",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center border-2 border-blue-500",children:e.jsx("span",{className:"text-xl font-bold text-blue-500",children:"G"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold",itemProp:"author",children:t.author_name}),e.jsx("p",{className:"text-gray-500",children:t.relative_time_description})]})]}),e.jsx("div",{className:"flex mb-3",children:y(t.rating)}),e.jsx("p",{className:"text-gray-600",itemProp:"reviewBody",children:t.text.length>200?`${t.text.substring(0,200)}...`:t.text})]},i)))}),r.length>3&&e.jsx("button",{onClick:k,className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-white rounded-full p-2 shadow-md text-[#167d36] hover:text-white hover:bg-[#167d36] transition-colors hidden md:block","aria-label":"Kitas atsiliepimas",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),r.length>3&&e.jsx("div",{className:"flex justify-center space-x-2 mt-6",children:r.map(((t,i)=>e.jsx("button",{onClick:()=>{w(!1),p(i),setTimeout((()=>w(!0)),1e4)},className:"w-2 h-2 rounded-full transition-colors "+(i===g?"bg-[#167d36]":"bg-gray-300"),"aria-label":`Peržiūrėti atsiliepimą ${i+1}`},i)))}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("a",{href:"https://g.page/r/CTBQpWddWnZDEBE/review",target:"_blank",rel:"noopener noreferrer",className:"inline-block bg-white text-[#167d36] px-6 py-3 rounded-lg font-semibold border-2 border-[#167d36] hover:bg-[#167d36] hover:text-white transition-colors",children:"Palikite atsiliepimą"})})]})})};export{r as default};
